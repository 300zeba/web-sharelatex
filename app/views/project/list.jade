extends ../layout

block scripts
	script(type="text/javascript").
		window.data = {
			projects: !{projects},
			tags: !{tags}
		};

	script(src=jsPath+'project-list.js')

block content

	script(type="text/x-handlebars", data-template-name="projects")

	
	.content.content-alt(ng-app="ProjectPageApp", ng-controller="ProjectPageController")
		.container
			.row
				.col-md-2
					#newProject.dropdown
						a.btn.btn-primary.dropdown-toggle(data-toggle="dropdown", href="#") New Project
						ul.dropdown-menu(role="menu")
							li
								a#blankNewProject(href="#", data-csrf=csrfToken) Blank Project
							li
								a#newProjectExample(href="#", data-csrf=csrfToken) Example Project
							li
								a#uploadNewProject(href="#", data-csrf=csrfToken) Upload Project
							li.divider
							li.dropdown-header Templates
							li
								a.menu-indent(href="/templates/cv") CV or Resume
							li
								a.menu-indent(href="/templates/cover-letters") Cover Letter
							li
								a.menu-indent(href="/templates/journals") Journal Article
							li
								a.menu-indent(href="/templates/presentations") Presentation
							li
								a.menu-indent(href="/templates/thesis") Thesis
							li
								a.menu-indent(href="/templates/bibliographies") Bibliographies
							li
								a.menu-indent(href="/templates") View All »
					.row-spaced
						ul.list-unstyled.folders-menu.js-folders-menu
							li
								a.menu-indent(href="#") All projects
							li
								a.menu-indent(href="#") Your projects
							li
								a.menu-indent(href="#") Shared with you
							li 
								h2 Folders
							li(ng-repeat="tag in tags", ng-controller="TagController")
								a.menu-indent(href="#")
									i.icon.fa.fa-folder-o
									|  {{tag.name}}
								span.small ({{tag.project_ids.length}})

					.row-spaced-small
						ul.list-unstyled.folders-menu
							li
								a.menu-indent(href="#")
									i.icon.fa.fa-plus
									|  New Folder

					-if (settings.enableSubscriptions)
						.row-spaced
							a(href="/user/bonus").btn.btn-info Upgrade Account

				.col-md-10(ng-controller="ProjectListController")
					.container-fluid
						.row
							.col-md-12
								form.project-search.form-horizontal(role="form")
									.form-group.has-feedback.col-md-7
										input(placeholder='Search projects…', autofocus='autofocus', ng-model="searchText").form-control.col-md-7
										i.fa.fa-search.form-control-feedback
									//- i.fa.fa-remove

								.project-tools.js-toggle-tools
									.btn-toolbar
										.btn-group
											a.btn.btn-default(href='#', data-toggle="tooltip", data-placement="bottom", title="", data-original-title="Download")
												i.fa.fa-cloud-download
											a.btn.btn-default(href='#', data-toggle="tooltip", data-placement="bottom", title="", data-original-title="Delete")
												i.fa.fa-trash-o

										.btn-group
											a.btn.btn-default.dropdown-toggle(href="#", data-toggle="dropdown")
												i.fa.fa-folder-open-o
												|  
												span.caret
											ul.dropdown-menu.dropdown-menu-right(role="menu")
												li.dropdown-header Add to folder
												li(ng-repeat="tag in tags", ng-controller="TagDropdownController")
													a.menu-indent(href="#", ng-click="addOrRemoveProjectsFromTag()")
														i.fa.fa-check(ng-if="areSelectedProjectsInTag")
														|  {{tag.name}}

										.btn-group
											a.btn.btn-default.dropdown-toggle(data-toggle="dropdown", href="#") More 
												span.caret
											ul.dropdown-menu.dropdown-menu-right(role="menu")
												li
													a(href='/project/'+"5369c5737fc6b47f048da1f5"+'/clone', data-csrf=csrfToken).cloneProject Make a Copy...
												-if ("owner" == "owner")
													li
														a(href='/project/'+"5369c5737fc6b47f048da1f5"+'/rename', data-name="the project", data-id="5369c5737fc6b47f048da1f5", data-csrf=csrfToken).renameProject Rename...
												-else
													li
														a(href='/project/'+"5369c5737fc6b47f048da1f5"+'/leave', data-name="the project", data-id="5369c5737fc6b47f048da1f5", data-csrf=csrfToken).leaveProject Leave Project
						.row.row-spaced
							.col-md-12
								.card.card-thin
									- if (projects.length > 0)
										ul.list-unstyled.project-list
											li.container-fluid
												.row
													.col-md-6
														input.select-all(type="checkbox", ng-model="allSelected", ng-change="onSelectAllChange()")
														span.title TITLE
													.col-md-2
														span.owner OWNER
													.col-md-4
														span.last-modified LAST MODIFIED
											li.project_entry.container-fluid(ng-repeat="project in visibleProjects", ng-controller="ProjectController")
												.row
													.col-md-6
														input.select-item(type="checkbox", ng-model="project.selected", ng-change="onSelectedChange()")
														span.title
															a.projectName(href="/project/{{project.id}}") {{project.name}}
													.col-md-2
														span.owner {{project.publicAccesLevel}}
													.col-md-4
														span.last-modified.isoDate {{project.lastUpdated | formatDate}}
									- else
										.row
											.span12
												.welcome
													h1
														i.fa.fa-arrow-left
														| Welcome! Follow the arrow to get started
													p New to LaTeX? Start by having a look at our
														a(href="/templates")  templates
														|  or
														a(href="/learn")  help guides
														| .
